# avito-bootcamp-assignment
![Coverage](https://img.shields.io/badge/Coverage-45.8%25-yellow)

[![Audit](https://github.com/Ropho/avito-bootcamp-assignment/actions/workflows/audit.yml/badge.svg?branch=master)](https://github.com/Ropho/avito-bootcamp-assignment/actions/workflows/audit.yml)

## Задание 
Задание состояло в создании сервиса домов, с помощью которого пользователь сможет продать квартиру, загрузив объявление на Авито.

## Реализация
В рамках задания был реализован весь требуемый базовый функционал:
- Авторизация пользователей с помощью DummyLogin, а также их регистрация и последующая авторизация при помощи механизма JWT токенов с разным уровнем доступа.
- Создание дома (только модератором)
- Создание квартиры
- Модерация квартиры (только модератором)
- Получение списка квартир по номеру дома (различная реализация для client & moderator уровней доступа)

Также был реализован дополнительный функционал:
- Была дана openAPI спецификация, по которой генерируем код с помощью генератора.
Так мы отвязываемся от рутинных задач по написанию ручек и посвящаем время написанию бизнес-логики, а также автоматизируем взаимодействие с заказчиком, ведь SOT (Source of truth) является спецификация сервиса, от которой сервис и должен отталкиваться.
	    
        wget -d --header="Accept: application/yaml" -O oas/openapi.yaml https://app.swaggerhub.com/apiproxy/registry/IVANKOVALENKOWORK/backend-bootcamp/1.0.0?resolved=true&flatten=true&pretty=true
- Реализован асинхронный механизм отправки нотификаций по email подписавшимся на обновление дома пользователем. Реализовано с использованием отдельной горутины с воркером-обработчиком входящих в канал email'ов. Никак не завязан на горутинах сервера (хендлеров)
- Настроен CI и поставлены badge, показывающие прохождение pipeline и процент покрытия кода тестами
- Логгер был использован стандартный, встроенный в билблиотеку мультиплексора-роутера chi (имеется в виду встроенный middleware для логгирования)

## Зависимости
- База исходя из ТЗ была выбрана PostgreSQL для хранения там таких моделей, как: user, house, flat, subscription
- Средство расзвертывания и контейниризации исходя из ТЗ были выбраны docker-compose и docker соответственно

## Доступные команды
- **make generate**   		: подготавливает, собирает необходимые зависимости для старта сервиса
- **make lint-full**  		: включает линтер (golang-ci-lint)
- **make test**       		: прогоняет unit-tests, сделанные на моках для слоя репозитория и слоя usecase
- **make test-integration-ci** 	: прогоняет интеграционные тесты, реализованные с поднятием тестовой базы данных и запуском сервиса.

